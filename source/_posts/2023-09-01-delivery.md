---
layout: post
categories: Mind
title: 如何提升软件交付效率

---

### 前言
一个团队的交付效率，体现着这个团队的战斗力。交付效率跟很多因素相关，仅谈效率其实并不全面。我们的最终目的其实是要提升「产能」和「有效性」。产能跟效率与工时有关，有效性跟方向的正确性和成果是否完成兑换有关。

- 产能：效率、工时

- 有效性：方向的正确性、成果是否完成兑换

<br/>

为了不让问题太多宽泛，也为了能讨论的更加细致，本文我们只讨论效率。其他因素方面的讨论，可以独立成文。

### 束水攻沙

「[束水攻沙](https://baike.baidu.com/item/%E6%9D%9F%E6%B0%B4%E6%94%BB%E6%B2%99/5895523)」是中国 明末专家 潘季驯 提出来的 治河之策（1565~1592），当时他根据黄河含沙量大的特点，提出了「以河治河，以水攻沙」的治河方策。以前人们在治理河水的时候，都是在不断加固两岸河堤，黄河水的含沙量较大，会导致河堤越加越高，甚至都出现了河水比两岸还要高的情况。这样当河水泛滥时，一旦河堤决口，河水就会奔涌而下，毁坏两岸房屋和农田。

<br/>

潘季驯 提出来的治河之策，反其道而行，他希望在治河的过程中增加河水流速，让河水能够快速流入大海，这样就不会造成阻塞。此外，增加流速的同时，这些水流会把河中的淤泥和沙子带走，导致河堤内部更低，即使决口造成的危险也更低。

<br/>

但是这跟交付效率又有什么关系呢？这关系很大。我们可以把河流理解为「软件产品的价值交付流」，河水只有最终流入大海才算完成，软件产品也只有最终交付到用户手中才算完成。如下图，所以交付软件，不就是治河嘛，我们应当向 潘季驯 学习「束水攻沙」，只有增加流速才能减少危害。把河堤垒的越来越高（待办列表越来越长），不能解决根本问题。

### 利特尔法则
[排队论](https://zh.wikipedia.org/zh-cn/%E7%AD%89%E5%80%99%E7%90%86%E8%AB%96) 中有一个著名的定律，称为 [利特尔法则](https://en.wikipedia.org/wiki/Little's_law)（Little's law），是由 约翰·利特尔 在 1954 年提出的，公式如下，
```
L: 平均滞留人数
λ: 吞吐率（单位时间内进入或离开的人数）
W: 平均等待时间

L = λW
```
因此，要想缩短平均等待时间 W，只能通过减少平均滞留人数 L，或增加吞吐率 λ 来实现。

<br/>

而「吞吐率」一般是很难立即提高的，这涉及到系统本身所能提供服务的效率。但是平均滞留人数却可以通过管理手段人为减少。对任何一道工序而言，在不增加工序本身工作效率「吞吐率」的情况下，仅仅减少在制品数量「平均滞留人数」，就可以大幅度的减少「平均等待时间」。
即，限制在制品（work-in-progress）数量，可以有效的缩短平均等待时间，从而提高「产能」。

<br/>

[利特尔法则](https://en.wikipedia.org/wiki/Little's_law) 是日本丰田汽车 [精益生产](https://zh.wikipedia.org/zh-tw/%E7%B2%BE%E7%9B%8A%E7%94%9F%E7%94%A2) 的理论基础（去库存，减少浪费），这也是为什么在软件开发中，大家追求持续集成、持续部署 的根本原因（[持续交付](https://zh.wikipedia.org/zh-cn/%E6%8C%81%E7%BA%8C%E4%BA%A4%E4%BB%98)）。

<br/>

> 精益生产 是上世纪 50 年代起，从丰田公司实践中演化出来的生产方式，又被称为「丰田生产方式」。1990 年麻省理工 James P. Womack 等几位教授提炼总结了丰田的实践，出版《[改变世界的机器](https://book.douban.com/subject/26431010/)》一书，精益生产的概念才开始为世人所认识和效仿。直至今日，它仍然是最先进的生产制造方式，是制造业共同追求的目标。丰田生产方式之父 大野耐一 说：丰田生产的两大支柱是「准时化」和「自动化」，「看板」是运营这一系统的工具。 —— [看板方法](https://www.woshipm.com/pd/54968.html)

<br/>

不幸的是，「看板」这个词在多数情况下被人误解了。它不是一个「让大家看的板子」，而是一个专有名词「Kanban」。它代表着人们如何通过「观察交付过程，减少平均等待时间，从而提高产能」这一努力的方向，而不是为了压进度、催交付，如果非得说它的精髓，那就是砍需求（减少滞留，赶紧做完）。

- 让大家看的板子：压进度、催交付（修堤筑河）

- Kanban：减少滞留，赶紧做完（束水攻沙）

### 为什么要注重交付

我并不想推广「看板」方法，我也不是看板方法的忠实信徒。回到主题，我想要做的事情是，通过一切有用的办法，提高软件团队的生产效率，从而提升整个团队的战斗力。

<br/>

不论是「束水攻沙」还是「利特尔法则」，都有反直觉的成分在里面。也就是说，如果真的要这样做的话，就得应对来自四面八方的舆论压力，因为它所提倡的跟通常的 工作方法/文化 截然不同，甚至有冲突。

- 具有更少的待办事项列表：是不是工作不饱和？

- 超快的交付节奏：是不是缺乏深入思考，有没有想好了再做？整体来看是否在浪费时间？

- 下班时间更早：既然还有那么多时间，为什么还在努力砍需求？

<br/>

比较容易说服人们的办法是，向大家介绍「[木桶原理](https://wiki.mbalib.com/wiki/%E6%9C%A8%E6%A1%B6%E5%8E%9F%E7%90%86)」和「[约束理论](https://wiki.mbalib.com/wiki/%E7%BA%A6%E6%9D%9F%E7%90%86%E8%AE%BA)」。

> 一只木桶能盛多少水，并不取决于桶壁上最高的那块木板，而是取决于「最短的那块」。

> 任何「非瓶颈资源」究竟能使系统赚多少钱，不是由它自己的潜能所决定，而是由系统中的其他制约因素所决定。

<br/>

在软件生产流程中，单点再快也没有用。代码写的再快，尚未部署上线（或者没有人来使用功能）也是没有用，充其量只是生产了一堆内容和资料。这些内容和资料，必须变成功能被人用，才能产生价值。所以软件开发团队，应该总是致力于两件事：

- 尽一切可能消除阻塞，让代码变成功能

- 尽一切可能验证功能的有效性，帮助用户解决问题

以上两点往往是自诩为「码农」的工程师，最容易被忽略的。软件开发并不是交差就完事了，优秀的工程师具有使命感，总是主动对外释放价值。

<br/>

### 如何消除阻塞

消除阻塞的办法，其实很简单，但执行起来却比较困难。消除阻塞，只需要识别阻塞点，并疏通阻塞就行了。识别阻塞很容易，疏通困难。在软件开发中，阻塞源于某些事项没有按照预期的时间完成，依赖这件事的人，就会处于等待状态，这是一种极其浪费人力的状态。因为阻塞点并不是只阻塞一个人，而可能是阻塞了一连串的事项，或者是一连串的人。大家都处于排队状态，平均等待时间乘以人数，量级会大到吓人。

<br/>

其实上文对于如何应对阻塞，已经告诉我我们办法了：「[束水攻沙](https://baike.baidu.com/item/%E6%9D%9F%E6%B0%B4%E6%94%BB%E6%B2%99/5895523)」和「[利特尔法则](https://en.wikipedia.org/wiki/Little's_law)」 。我们应当想办法让阻塞之处，赶紧交付，让水流（价值流）畅通。有两个办法：

- 改变优先级：别的事情不做，先做这个

- 砍需求：先交付重要的部分

<br/>

这两个办法有时候，都需要一定的管理手段才能完成。因为调整优先级、砍需求 往往不是做事的人说了算的，而是分配工作的人说了算。所以如何让分配工作的人，认识到项目风险（阻塞）才是关键之所在。这就需要我们提升项目的可见性，甚至不同项目之间还要经常权衡。只有让资源的所有者看到风险，才有可能调整资源投入情况。

<br/>

自下而上的让一线开发自己来调整，这是不太可行的，因为这会涉及到工作表现问题。

- 做不完是不是能力差

- 做不完是不是工作不饱和

- 做不完是不是不够用心

<br/>

我很想说的是，在任何团队我们都应该建立「科学的项目管理观」，在已经利用好现有的 人力/能力 基础上，就完全可以打造出一个高绩效的团队了。软件开发不是打仗（不是体力劳动），大家不用拼死一战，而是要靠脑子和正确的方法赢得商战。

### 如何提升功能的有效性

习惯流水线工作的工程师，对于整个价值交付的全貌是不理解的。这是分工造成的，工程师只要完成编码，不用关心功能是否有用。最终的软件功能，是否用户喜爱，是否能解决用户的问题，这是产品经理的事情。这种思路是非常有害的，甚至有些人会认为，功能如何被用户所使用，是用户应该自学的。后者说，功能如何被用户所知，那是负责宣传工作的人应该做的，不是工程师该考虑的问题。

<br/>

以上种种问题，就是社会化大分工场景下的窘态，这会导致大家虽然看起来很忙，但其实没有忙到点子上。即使功能效率的效率再高，不为用户所知，使用起来太难，那会大大折损这件事情的最终价值。

<br/>

> 有这样一种观点，认为设计优良的框架，细致考虑并精巧实现的架构自然会被人们重复利用。事实上，即便是最精美，最优雅的框架，可复用性最高的系统，也必须满足下面的条件才可能被复用。

> 1. 大家知道它们存在

> 2. 大家知道如何使用它们

> 3. 大家认识到利用已有资源好过自己动手

> —— 《[软件架构师应该知道的 97 件事](https://book.douban.com/subject/4745287/)》

架构如此，任何软件功能亦如此。提升功能的有效性，首先应该意识到有这个问题，其次才是考虑如何提升。提升有效性的一个常用做法是，建立「反馈循环」（也称为科学方法）。自然科学家们就是用这种方式，不断的打磨/修正 人们对大自然的认识。

- 细致的观察真实世界的特点

- 根据观察结果提出假设模型

- 根据模型预测未来的事件

- 继续观察并核实预测的准确性

- 如此反复直到确认预测和观察一致

你敢相信么，以上关于科学方法的描述，居然出自于《[算法](https://book.douban.com/subject/19952400/)》这本书。所以强调科学方法，并不是为了标新立异，而是它确实是被实践证明的有效方法。

### 空想之地

如果你实在觉得「科学方法」实在太过学术派，那么在《[Scrum：用一半的时间、做两倍的事](https://book.douban.com/subject/26544610/)》中，也曾提到过「PDCA 循环」（它是 Scrum 思想的由来），这是 Scrum 作者在越南接受飞行训练的指导法则：

- 规划（Plan）

- 执行（Do）

- 检核（Check）

- 行动（Act）

要精确衡量已经完成的工作，以及成果的好坏，并追求「持续改善」。别只改善一次，要持续改善，永远都要找到可供改善之处，永远不要安于现状。
所以提升功能有效性的办法是，要让自己的想法跟外界产生交互，做到持续改善。

<br/>

每一位有志于提升功能有效的工程师，都应该读一下《[做对产品](https://book.douban.com/subject/35607961//)》这本书。我自己在第一次读这本书的时候，浑身冷汗直冒，
如果一个创意在「空想之地」逗留时间太长，就会陷入由未经证实的恣意判断、信念、偏好 和 预测 组成的谜团之中。

<br/>

我们无法只通过思考就判断出一个创意是否 “正确的它”，靠你自己的思考做不到，靠别人的思考或观点也不行，靠所谓 “专家” 的思考也是一样。有时候，我们会发现自己原来的预测是对的，但那大部分都是运气使然。

<br/>

只要你还待在空想之地，就无法把 “正确的它” 给推导出或诱导出来，你只能通过在真实世界中进行试验，来把它发掘出来。

<br/>

把自己的想法尽快落地，把 Beta 版的软件尽快拿出来，在真实世界中进行试验。不要担心一开始给人们的印象不好，只要能解决问题，我们可以向大家强调，这是为了解决问题而用来「快速试错」的试行版本。谁能比竞品更快的出现在用户视野，谁就有了更多直接的反馈，也就有了更早的机会修正自己的功能设计，以及有了更早的时间点识别失败的创意。

### 小结

本文介绍了我对软件交付的理解，以及提升交付效率需要额外关注的两点，

- 始终致力于消除阻塞

- 尽早的建立反馈循环

如果你的团队还没有认识到这些，说明整体的战斗力水平还具有很大的挖掘空间。丰田公司是如何作为后起之秀，成为世界汽车行业巨头的，这都是真实存在的例子。当众多汽车公司，还在沉浸于工业革命所带来的「批量生产」之快感中时，丰田生产方法告诫人们，去库存、减少在制品数量，可以提高产能。

<br/>

文中以上的想法，并不是来源于我个人，我只是对现在正在经历着的软件行业的革命，进行了一次汇总。「[束水攻沙](https://baike.baidu.com/item/%E6%9D%9F%E6%B0%B4%E6%94%BB%E6%B2%99/5895523)」「[利特尔法则](https://en.wikipedia.org/wiki/Little's_law)」「[木桶原理](https://wiki.mbalib.com/wiki/%E6%9C%A8%E6%A1%B6%E5%8E%9F%E7%90%86)」「[约束理论](https://wiki.mbalib.com/wiki/%E7%BA%A6%E6%9D%9F%E7%90%86%E8%AE%BA)」，这些框架以后一定改变软件开发生态，将软件研发效能提升到一个新的境界。

